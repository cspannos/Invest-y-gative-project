{"ast":null,"code":"'use strict';\n\nvar dagNodeUtil = require('./util');\n\nvar cloneLinks = dagNodeUtil.cloneLinks;\nvar cloneData = dagNodeUtil.cloneData;\nvar toDAGLink = dagNodeUtil.toDAGLink;\n\nvar DAGLink = require('../dag-link');\n\nvar DAGNode = require('./index');\n\nvar create = require('./create');\n\nfunction asDAGLink(link, callback) {\n  if (DAGLink.isDAGLink(link)) {\n    // It's a DAGLink instance\n    // no need to do anything\n    return callback(null, link);\n  }\n\n  if (DAGNode.isDAGNode(link)) {\n    // It's a DAGNode instance\n    // convert to link\n    return toDAGLink(link, {}, callback);\n  } // It's a Object with name, multihash/hash/cid and size\n\n\n  try {\n    callback(null, new DAGLink(link.name, link.size, link.multihash || link.hash || link.cid));\n  } catch (err) {\n    return callback(err);\n  }\n}\n\nfunction addLink(node, link, callback) {\n  var links = cloneLinks(node);\n  var data = cloneData(node);\n  asDAGLink(link, function (error, link) {\n    if (error) {\n      return callback(error);\n    }\n\n    links.push(link);\n    create(data, links, callback);\n  });\n}\n\nmodule.exports = addLink;","map":null,"metadata":{},"sourceType":"script"}